{"ast":null,"code":"import _regeneratorRuntime from\"/Users/stoocom/Desktop/Geekbrains/Project/Kamasutra/social_network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/stoocom/Desktop/Geekbrains/Project/Kamasutra/social_network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/stoocom/Desktop/Geekbrains/Project/Kamasutra/social_network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{authAPI}from\"../api/authApi\";import{stopSubmit}from\"redux-form\";var SET_USER_DATA='auth/SET_USER_DATA';var initialState={id:null,login:null,email:null,isAuth:false};var authReducer=function authReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_USER_DATA:return _objectSpread({},state,{},action.data);default:return state;}};export var setAuthUserData=function setAuthUserData(id,login,email,isAuth){return{type:SET_USER_DATA,data:{id:id,login:login,email:email,isAuth:isAuth}};};export var getLoginThunkCreator=function getLoginThunkCreator(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response,_response$data$data,id,login,email;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return authAPI.getLogin();case 2:response=_context.sent;if(response.data.resultCode===0){_response$data$data=response.data.data,id=_response$data$data.id,login=_response$data$data.login,email=_response$data$data.email;dispatch(setAuthUserData(id,login,email,true));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var loginThunkCreator=function loginThunkCreator(email,password,rememberMe){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response,message,action;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return authAPI.login(email,password,rememberMe);case 2:response=_context2.sent;if(response.data.resultCode===0){dispatch(getLoginThunkCreator());}else{message=response.data.messages.length>0?response.data.messages[0]:\"Some error\";action=stopSubmit(\"login\",{_error:message});dispatch(action);}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logoutThunkCreator=function logoutThunkCreator(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return authAPI.logout();case 2:response=_context3.sent;if(response.data.resultCode===0){dispatch(setAuthUserData(null,null,null,false));}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export default authReducer;","map":{"version":3,"sources":["/Users/stoocom/Desktop/Geekbrains/Project/Kamasutra/social_network/src/redux/authReducer.js"],"names":["authAPI","stopSubmit","SET_USER_DATA","initialState","id","login","email","isAuth","authReducer","state","action","type","data","setAuthUserData","getLoginThunkCreator","dispatch","getLogin","response","resultCode","loginThunkCreator","password","rememberMe","message","messages","length","_error","logoutThunkCreator","logout"],"mappings":"uiBAAA,OAASA,OAAT,KAAwB,gBAAxB,CACA,OAASC,UAAT,KAA2B,YAA3B,CAEA,GAAMC,CAAAA,aAAa,CAAG,oBAAtB,CAEA,GAAIC,CAAAA,YAAY,CAAG,CACfC,EAAE,CAAE,IADW,CAEfC,KAAK,CAAE,IAFQ,CAGfC,KAAK,CAAE,IAHQ,CAIfC,MAAM,CAAE,KAJO,CAAnB,CAOA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAkC,IAAjCC,CAAAA,KAAiC,2DAAzBN,YAAyB,IAAXO,CAAAA,MAAW,2CAClD,OAAQA,MAAM,CAACC,IAAf,EAEI,IAAKT,CAAAA,aAAL,CACI,wBACOO,KADP,IAEOC,MAAM,CAACE,IAFd,EAKJ,QACI,MAAOH,CAAAA,KAAP,CATR,CAWH,CAZD,CAcA,MAAO,IAAMI,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACT,EAAD,CAAKC,KAAL,CAAYC,KAAZ,CAAmBC,MAAnB,CAA8B,CACzD,MAAO,CAAEI,IAAI,CAAET,aAAR,CAAuBU,IAAI,CAAE,CAAER,EAAE,CAAFA,EAAF,CAAMC,KAAK,CAALA,KAAN,CAAaC,KAAK,CAALA,KAAb,CAAoBC,MAAM,CAANA,MAApB,CAA7B,CAAP,CACH,CAFM,CAIP,MAAO,IAAMO,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,kGAAM,iBAAOC,QAAP,wLACjBf,CAAAA,OAAO,CAACgB,QAAR,EADiB,QAClCC,QADkC,eAEtC,GAAIA,QAAQ,CAACL,IAAT,CAAcM,UAAd,GAA6B,CAAjC,CAAoC,qBACLD,QAAQ,CAACL,IAAT,CAAcA,IADT,CAC1BR,EAD0B,qBAC1BA,EAD0B,CACtBC,KADsB,qBACtBA,KADsB,CACfC,KADe,qBACfA,KADe,CAEhCS,QAAQ,CAACF,eAAe,CAACT,EAAD,CAAKC,KAAL,CAAYC,KAAZ,CAAmB,IAAnB,CAAhB,CAAR,CACH,CALqC,sDAAN,gEAA7B,CASP,MAAO,IAAMa,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACb,KAAD,CAAQc,QAAR,CAAkBC,UAAlB,kGAAiC,kBAAON,QAAP,yKAIzCf,CAAAA,OAAO,CAACK,KAAR,CAAcC,KAAd,CAAqBc,QAArB,CAA+BC,UAA/B,CAJyC,QAI1DJ,QAJ0D,gBAK9D,GAAIA,QAAQ,CAACL,IAAT,CAAcM,UAAd,GAA6B,CAAjC,CAAoC,CAChCH,QAAQ,CAACD,oBAAoB,EAArB,CAAR,CACH,CAFD,IAEO,CACCQ,OADD,CACWL,QAAQ,CAACL,IAAT,CAAcW,QAAd,CAAuBC,MAAvB,CAAgC,CAAhC,CAAoCP,QAAQ,CAACL,IAAT,CAAcW,QAAd,CAAuB,CAAvB,CAApC,CAAgE,YAD3E,CAECb,MAFD,CAEUT,UAAU,CAAC,OAAD,CAAU,CAAEwB,MAAM,CAAEH,OAAV,CAAV,CAFpB,CAGHP,QAAQ,CAACL,MAAD,CAAR,CACH,CAX6D,wDAAjC,kEAA1B,CAcP,MAAO,IAAMgB,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,mGAAM,kBAAOX,QAAP,0JACff,CAAAA,OAAO,CAAC2B,MAAR,EADe,QAChCV,QADgC,gBAEpC,GAAIA,QAAQ,CAACL,IAAT,CAAcM,UAAd,GAA6B,CAAjC,CAAoC,CAChCH,QAAQ,CAACF,eAAe,CAAC,IAAD,CAAO,IAAP,CAAa,IAAb,CAAmB,KAAnB,CAAhB,CAAR,CACH,CAJmC,wDAAN,kEAA3B,CAQP,cAAeL,CAAAA,WAAf","sourcesContent":["import { authAPI } from \"../api/authApi\"\nimport { stopSubmit } from \"redux-form\"\n\nconst SET_USER_DATA = 'auth/SET_USER_DATA'\n\nlet initialState = {\n    id: null,\n    login: null,\n    email: null,\n    isAuth: false,\n}\n\nconst authReducer = (state = initialState, action) => {\n    switch (action.type) {\n\n        case SET_USER_DATA:\n            return {\n                ...state,\n                ...action.data,\n                //isAuth: action.data.isAuth,\n            }\n        default:\n            return state\n    }\n}\n\nexport const setAuthUserData = (id, login, email, isAuth) => {\n    return { type: SET_USER_DATA, data: { id, login, email, isAuth } }\n}\n\nexport const getLoginThunkCreator = () => async (dispatch) => {\n    let response = await authAPI.getLogin()\n    if (response.data.resultCode === 0) {\n        let { id, login, email } = response.data.data\n        dispatch(setAuthUserData(id, login, email, true))\n    }\n}\n\n\nexport const loginThunkCreator = (email, password, rememberMe) => async (dispatch) => {\n\n    // let action = stopSubmit(\"login\", {_error: \"Email is wrong\"})\n    // dispatch(action)\n    let response = await authAPI.login(email, password, rememberMe)\n    if (response.data.resultCode === 0) {\n        dispatch(getLoginThunkCreator())\n    } else {\n        let message = response.data.messages.length > 0 ? response.data.messages[0] : \"Some error\"\n        let action = stopSubmit(\"login\", { _error: message })\n        dispatch(action)\n    }\n}\n\nexport const logoutThunkCreator = () => async (dispatch) => {\n    let response = await authAPI.logout()\n    if (response.data.resultCode === 0) {\n        dispatch(setAuthUserData(null, null, null, false))\n    }\n}\n\n\nexport default authReducer"]},"metadata":{},"sourceType":"module"}