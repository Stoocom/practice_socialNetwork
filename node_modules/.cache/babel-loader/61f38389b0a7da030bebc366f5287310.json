{"ast":null,"code":"import _regeneratorRuntime from\"/Users/stoocom/Desktop/Geekbrains/Project/Kamasutra/social_network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/stoocom/Desktop/Geekbrains/Project/Kamasutra/social_network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/Users/stoocom/Desktop/Geekbrains/Project/Kamasutra/social_network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/stoocom/Desktop/Geekbrains/Project/Kamasutra/social_network/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{usersAPI}from\"../api/api\";import{updateObjectInArray}from'../utils/object-helper';var FOLLOW='FOLLOW';var UNFOLLOW='UNFOLLOW';var SET_USERS='SET_USERS';var SET_NEW_USERS='SET_NEW_USERS';var SET_TOTAL_COUNT='SET_TOTAL_COUNT';var SET_LOADING='SET_LOADING';var TOGGLE_FOLLOWING_PROGRESS='TOGGLE_FOLLOWING_PROGRESS';var initialState={users:[],pageSize:5,totalCount:0,currentPage:1,isLoading:true,followingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread({},state,{users:updateObjectInArray(state.users,action.userId,'id',{followed:false})// users: state.users.map((u) => {\n//     if (u.id === action.userId) {\n//         return {\n//             ...u,\n//             followed: false\n//         }\n//     }\n//     return u\n// })\n});case UNFOLLOW:return _objectSpread({},state,{users:updateObjectInArray(state.users,action.userId,'id',{followed:true})});case SET_USERS:return _objectSpread({},state,{users:_toConsumableArray(action.users)});case SET_TOTAL_COUNT:return _objectSpread({},state,{totalCount:action.total});case SET_NEW_USERS:return _objectSpread({},state,{currentPage:action.count});case SET_LOADING:return _objectSpread({},state,{isLoading:action.isLoading});case TOGGLE_FOLLOWING_PROGRESS:return _objectSpread({},state,{followingInProgress:action.isLoading?[].concat(_toConsumableArray(state.followingInProgress),[action.userId]):state.followingInProgress.filter(function(id){return id!==action.userId;})});default:return state;}};export var followSuccess=function followSuccess(userId){return{type:FOLLOW,userId:userId};};export var unfollowSuccess=function unfollowSuccess(userId){return{type:UNFOLLOW,userId:userId};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var setCurrentPage=function setCurrentPage(pageNumber){return{type:SET_NEW_USERS,count:pageNumber};};export var setTotalCount=function setTotalCount(totalCount){return{type:SET_TOTAL_COUNT,total:totalCount};};export var setLoading=function setLoading(isLoading){return{type:SET_LOADING,isLoading:isLoading};};export var toggleFollowingProgress=function toggleFollowingProgress(isLoading,userId){return{type:TOGGLE_FOLLOWING_PROGRESS,isLoading:isLoading,userId:userId};};export var getUsersThunkCreator=function getUsersThunkCreator(currentPage,pageSize){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(setLoading(true));dispatch(setCurrentPage(currentPage));_context.next=4;return usersAPI.getUsers(currentPage,pageSize);case 4:data=_context.sent;dispatch(setLoading(false));dispatch(setUsers(data.items));dispatch(setTotalCount(data.totalCount));case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var follow=function follow(userId){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(toggleFollowingProgress(true,userId));_context2.next=3;return usersAPI.unfollow(userId);case 3:response=_context2.sent;if(response.data.resultCode===0){console.log('Перевод в друзья');dispatch(unfollowSuccess(userId));}dispatch(toggleFollowingProgress(false,userId));case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var unfollow=function unfollow(userId){return function(dispatch){dispatch(toggleFollowingProgress(true,userId));usersAPI.follow(userId).then(function(response){if(response.data.resultCode===0){console.log('Нет в друзьях');dispatch(followSuccess(userId));}dispatch(toggleFollowingProgress(false,userId));});};};export default usersReducer;","map":{"version":3,"sources":["/Users/stoocom/Desktop/Geekbrains/Project/Kamasutra/social_network/src/redux/usersReducer.js"],"names":["usersAPI","updateObjectInArray","FOLLOW","UNFOLLOW","SET_USERS","SET_NEW_USERS","SET_TOTAL_COUNT","SET_LOADING","TOGGLE_FOLLOWING_PROGRESS","initialState","users","pageSize","totalCount","currentPage","isLoading","followingInProgress","usersReducer","state","action","type","userId","followed","total","count","filter","id","followSuccess","unfollowSuccess","setUsers","setCurrentPage","pageNumber","setTotalCount","setLoading","toggleFollowingProgress","getUsersThunkCreator","dispatch","getUsers","data","items","follow","unfollow","response","resultCode","console","log","then"],"mappings":"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","sourcesContent":["import { usersAPI } from \"../api/api\"\nimport { updateObjectInArray } from '../utils/object-helper'\n\nconst FOLLOW = 'FOLLOW'\nconst UNFOLLOW = 'UNFOLLOW'\nconst SET_USERS = 'SET_USERS'\nconst SET_NEW_USERS = 'SET_NEW_USERS'\nconst SET_TOTAL_COUNT = 'SET_TOTAL_COUNT'\nconst SET_LOADING = 'SET_LOADING'\nconst TOGGLE_FOLLOWING_PROGRESS = 'TOGGLE_FOLLOWING_PROGRESS'\n\nlet initialState = {\n    users: [],\n    pageSize: 5,\n    totalCount: 0,\n    currentPage: 1,\n    isLoading: true,\n    followingInProgress: [],\n}\n\nconst usersReducer = (state = initialState, action) => {\n    switch (action.type) {\n        case FOLLOW:\n            return {\n                ...state,\n                users: updateObjectInArray(state.users, action.userId, 'id', { followed: false })\n                // users: state.users.map((u) => {\n                //     if (u.id === action.userId) {\n                //         return {\n                //             ...u,\n                //             followed: false\n                //         }\n                //     }\n                //     return u\n                // })\n            }\n        case UNFOLLOW:\n            return {\n                ...state,\n                users: updateObjectInArray(state.users, action.userId, 'id', { followed: true })\n            }\n        case SET_USERS:\n            return {\n                ...state,\n                users: [...action.users],\n            }\n        case SET_TOTAL_COUNT:\n            return {\n                ...state,\n                totalCount: action.total,\n            }\n        case SET_NEW_USERS:\n            return {\n                ...state,\n                currentPage: action.count\n            }\n        case SET_LOADING:\n            return {\n                ...state,\n                isLoading: action.isLoading\n            }\n        case TOGGLE_FOLLOWING_PROGRESS:\n            return {\n                ...state,\n                followingInProgress: action.isLoading\n                    ? [...state.followingInProgress, action.userId]\n                    : state.followingInProgress.filter(id => id !== action.userId),\n\n            }\n        default:\n            return state\n    }\n}\n\nexport const followSuccess = (userId) => { return { type: FOLLOW, userId } }\nexport const unfollowSuccess = (userId) => { return { type: UNFOLLOW, userId } }\nexport const setUsers = (users) => { return { type: SET_USERS, users } }\nexport const setCurrentPage = (pageNumber) => { return { type: SET_NEW_USERS, count: pageNumber } }\nexport const setTotalCount = (totalCount) => { return { type: SET_TOTAL_COUNT, total: totalCount } }\nexport const setLoading = (isLoading) => { return { type: SET_LOADING, isLoading } }\nexport const toggleFollowingProgress = (isLoading, userId) => { return { type: TOGGLE_FOLLOWING_PROGRESS, isLoading, userId } }\n\nexport const getUsersThunkCreator = (currentPage, pageSize) => {\n    return async dispatch => {\n        dispatch(setLoading(true))\n        dispatch(setCurrentPage(currentPage))\n        let data = await usersAPI.getUsers(currentPage, pageSize)\n        dispatch(setLoading(false))\n        dispatch(setUsers(data.items))\n        dispatch(setTotalCount(data.totalCount))\n    }\n}\nexport const follow = (userId) => {\n    return async dispatch => {\n        dispatch(toggleFollowingProgress(true, userId))\n        let response = await usersAPI.unfollow(userId)\n        if (response.data.resultCode === 0) {\n            console.log('Перевод в друзья')\n            dispatch(unfollowSuccess(userId))\n        }\n        dispatch(toggleFollowingProgress(false, userId))\n    }\n}\nexport const unfollow = (userId) => {\n    return dispatch => {\n        dispatch(toggleFollowingProgress(true, userId))\n        usersAPI.follow(userId).then(response => {\n            if (response.data.resultCode === 0) {\n                console.log('Нет в друзьях')\n                dispatch(followSuccess(userId))\n            }\n            dispatch(toggleFollowingProgress(false, userId))\n        })\n    }\n}\n\nexport default usersReducer"]},"metadata":{},"sourceType":"module"}